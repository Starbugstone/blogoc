{% extends "Base.twig" %}

{% block title %}Category Page{% endblock %}

{% block main %}
    {% for post in posts %}

        <div class="col-12 my-2">
            <article class="category-listing shadow-sm border-dark">
                <div class="row justify-content-center no-gutters">
                    <div class="col-md-10 text-center">
                        <h2 class="entry-title">
                            <a href="/post/view-post/{{ post.posts_slug }}">{{ post.title }}</a>
                        </h2>
                    </div>
                </div>

                <div class="row align-items-center no-gutters">
                    <div class="col-md-3">
                        <div class="index_article_post_image ml-1">
                            <a class="index_article_post_image_link hoverImage rounded"
                               href="/post/view-post/{{ post.posts_slug }}">
                                <div class="postThumbnail rounded border-dark shadow-sm" style="background-image : url({{ post.post_image }})">
                                </div>
                            </a>
                        </div>
                    </div>
                    <div class="col-md-9 px-2 text-center">
                        {{ post.excerpt|raw  }}
                    </div>

                </div>
                {% if session.user_role_level >= 2 %}
                <div class="admin float-right mr-3 mt-2">
                    <a href="/admin/post/modify/{{ post.posts_slug }}">Edit <i class="fa fa-pencil" aria-hidden="true"></i></a>
                </div>
                {% endif %}

            </article>

        </div>
    {% endfor %}
    <div class="pagination">
    {# Taking care of the pagination #}
    {# generating previous / next page url, Are we searching in a category or all pages ? #}
    {% set categorySlugUrl = "all-posts/" %}
    {% if categorySlug is defined %}
        {% set categorySlugUrl = "posts/"~categorySlug~"/" %}
    {% endif %}
    <p>
    {# Creating previous and next page links #}
    {% if pagination.pageNo > "1" %}
        <a href="/category/{{ categorySlugUrl }}page-{{ pagination.pageNo-1 }}" class="float-left">Previous page</a>
    {% endif %}
    {% if pagination.pageNo  < pagination.totalPages %}
        <a href="/category/{{ categorySlugUrl }}page-{{ pagination.pageNo+1 }}" class="float-right">Next page</a>
    {% endif %}
    </p>
    </div>
{% endblock %}

{% block js %}
{% endblock %}